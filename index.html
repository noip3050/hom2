<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D Indoor Navigation</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- البيئة -->
      <a-sky color="#ECECEC"></a-sky>

      <!-- الجدران والغرف -->
      <!-- الجدران الخارجية -->
      <a-box position="0 1.5 -10" width="20" height="3" depth="0.2" color="#888"></a-box>
      <a-box position="-10 1.5 0" width="0.2" height="3" depth="20" color="#888"></a-box>
      <a-box position="10 1.5 0" width="0.2" height="3" depth="20" color="#888"></a-box>
      <a-box position="0 1.5 10" width="20" height="3" depth="0.2" color="#888"></a-box>

      <!-- الممرات (الأسياح) -->
      <a-box position="0 1.5 0" width="2" height="3" depth="0.2" color="#444"></a-box>
      <a-box position="-5 1.5 -5" width="0.2" height="3" depth="10" color="#444"></a-box>
      <a-box position="5 1.5 -5" width="0.2" height="3" depth="10" color="#444"></a-box>

      <!-- الغرف -->
      <a-box
        position="-7.5 1.5 -7.5"
        width="5"
        height="3"
        depth="5"
        color="#FFC300"
      >
        <a-text
          value="المطبخ"
          position="0 1.8 0"
          align="center"
          color="#000"
        ></a-text>
      </a-box>

      <a-box
        position="7.5 1.5 -7.5"
        width="5"
        height="3"
        depth="5"
        color="#4CAF50"
      >
        <a-text
          value="غرفة النوم"
          position="0 1.8 0"
          align="center"
          color="#FFF"
        ></a-text>
      </a-box>

      <a-box
        position="0 1.5 7.5"
        width="5"
        height="3"
        depth="5"
        color="#2196F3"
      >
        <a-text
          value="المجلس"
          position="0 1.8 0"
          align="center"
          color="#FFF"
        ></a-text>
      </a-box>

      <!-- الكاميرا -->
      <a-entity id="camera" camera position="0 1.6 0">
        <a-camera position="0 1.6 0"></a-camera>
      </a-entity>
    </a-scene>

    <!-- قائمة تفاعلية -->
    <div
      id="menu"
      style="position: absolute; top: 10px; left: 10px; z-index: 100;"
    >
      <button onclick="navigateTo('-7.5 -7.5')">المطبخ</button>
      <button onclick="navigateTo('7.5 -7.5')">غرفة النوم</button>
      <button onclick="navigateTo('0 7.5')">المجلس</button>
    </div>

    <script>
      const camera = document.querySelector("#camera");

      // وظيفة التنقل إلى غرفة محددة
      function navigateTo(target) {
        const [x, z] = target.split(" ").map(Number);

        // رسم خط موجه
        const line = document.createElement("a-entity");
        line.setAttribute(
          "line",
          `start: ${camera.getAttribute("position").x} 0.1 ${
            camera.getAttribute("position").z
          }; end: ${x} 0.1 ${z}; color: red;`
        );
        document.querySelector("a-scene").appendChild(line);

        // تشغيل صوت الإرشاد
        const speech = new SpeechSynthesisUtterance();
        speech.text = `اتجه نحو ${
          x === -7.5 ? "المطبخ" : x === 7.5 ? "غرفة النوم" : "المجلس"
        }`;
        speech.lang = "ar-SA";
        window.speechSynthesis.speak(speech);
      }

      // التحكم في الكاميرا عبر الحساسات
      window.addEventListener("deviceorientation", (event) => {
        camera.setAttribute("rotation", {
          x: 0,
          y: event.alpha || 0,
          z: 0,
        });
      });
    </script>
  </body>
</html>
